
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-LXJ5Q7LKKE"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-LXJ5Q7LKKE');
        </script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Hero Utilization</title>
        <link rel="icon" type="image/png" href="icons/favicon.webp">
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style">
        <link rel="stylesheet" href="./styles.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    </head>
    <body>
        <div class="title-container">
            <h1 class="title-header">
                <a href="index.html" class="home-link">
                    <i class="fas fa-home"></i>
                </a>
                Hero Utilization
                <span class="tournament-badge">Main 44</span>
            </h1>
        </div>
        <div id="search-container" style="display: flex; align-items: center;">
            <button class="button-group button-group--yellow" id="my-favorites-group">
                <span class="button-label">My Favorites</span>
                <i class="fa-regular fa-star"></i>
            </button>
            <input type="text" id="hero-search-box" class="search-box" placeholder="Search Heroes">
            <span class="clear-search"></span>
        </div>
        <div class="small-text" style="line-height: 1.25;">
            <span id="timestamp">2025-03-27 00:59 UTC</span>
            <span id="timeAgo"></span>
            <span class="info-text"> | Heroes: 4 &nbsp;|&nbsp; Decks: 1 &nbsp;|&nbsp; Cards: 5 &nbsp;|&nbsp;</span>
            <div class="gradient-container">
                <span class="gradient-label">Utilization ~ &nbsp; </span>
                <span class="gradient-label">Min</span>
                <div class="gradient-bar"></div>
                <span class="gradient-label">Max</span>
            </div>
        </div>
        <!-- Main Hero Table -->
        <div class="table-container">
            <table id="heroesTable">
            <tr>
                <th></th>
                <th style="text-align: left;"></th>
                <th class="utilization-columns" data-sort="hero_fantasy_score">Score <div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down active"></span></div></th>
                <th class="utilization-columns" data-sort="card_supply_utilization">ðŸ”’ Supply <div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
                <th class="utilization-columns" data-sort="elite_utilization"><img src="/icons/elite.webp" class="league-icon" alt="Elite"><div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
                <th class="utilization-columns" data-sort="gold_utilization"><img src="/icons/gold.webp" class="league-icon" alt="Gold"><div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
                <th class="utilization-columns" data-sort="silver_utilization"><img src="/icons/silver.webp" class="league-icon" alt="Silver"><div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
                <th class="utilization-columns" data-sort="bronze_utilization"><img src="/icons/bronze.webp" class="league-icon" alt="Bronze"><div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
                <th class="utilization-columns" data-sort="reverse_utilization"><img src="/icons/reverse.webp" class="league-icon" alt="Reverse"><div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
                <th class="utilization-columns" data-sort="total_utilization">Total<div class="sort-arrows"><span class="sort-arrow up"></span><span class="sort-arrow down"></span></div></th>
            </tr>
    
            <tr>
                <td class="rank">1</td>
                <td class="hero-column">
                    <img src="https://pbs.twimg.com/profile_images/1766117510221307904/z7IRFqRq_normal.jpg" class="hero-image" alt="Loopifyyy">
                    <span>Loopifyyy</span>
                </td>
                <td data-value="502.4410700474023" style="color: #006837;">502</td> 
                <td data-value="0.0007168458781362007"><span style="color: #5e4fa2">0.1%</span><br><span class="small-count">(1 of 1395)</span></td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span></td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span><br><span class="small-count">(1 of 1)</span></td>
            </tr>
        
            <tr>
                <td class="rank">2</td>
                <td class="hero-column">
                    <img src="https://pbs.twimg.com/profile_images/1875909635665719296/TXVdAYp6_normal.jpg" class="hero-image" alt="sumfattytuna">
                    <span>sumfattytuna</span>
                </td>
                <td data-value="336.5503554930045" style="color: #d1eb85;">336</td> 
                <td data-value="0.0006377551020408164"><span style="color: #91d2a4">0.1%</span><br><span class="small-count">(1 of 1568)</span></td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span></td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span><br><span class="small-count">(1 of 1)</span></td>
            </tr>
        
            <tr>
                <td class="rank">3</td>
                <td class="hero-column">
                    <img src="https://pbs.twimg.com/profile_images/1856048699132063744/SuLKAaU7_normal.jpg" class="hero-image" alt="0xrwu">
                    <span>0xrwu</span>
                </td>
                <td data-value="124.06968605953236" style="color: #dd3d2d;">124</td> 
                <td data-value="0.0005534034311012728"><span style="color: #fef1a7">0.1%</span><br><span class="small-count">(1 of 1807)</span></td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span></td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span><br><span class="small-count">(1 of 1)</span></td>
            </tr>
        
            <tr>
                <td class="rank">4</td>
                <td class="hero-column">
                    <img src="https://pbs.twimg.com/profile_images/1866137934794989568/C9qqade1_normal.jpg" class="hero-image" alt="vers_laLune">
                    <span>vers_laLune</span>
                </td>
                <td data-value="70.8127416950448" style="color: #a50026;">70</td> 
                <td data-value="0.00041718815185648727"><span style="color: #9e0142">0.0%</span><br><span class="small-count">(1 of 2397)</span></td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span></td>
                <td data-value="0">-</td>
                <td data-value="1.0"><span style="color: #9e0142">100.0%</span><br><span class="small-count">(1 of 1)</span></td>
            </tr>
        
            </tbody>
            </table>
        </div>
            <script>
            
                 // Add this new event listener for the star
                document.addEventListener('DOMContentLoaded', function() {
                    const buttonGroup = document.querySelector('#my-favorites-group');
                    const icon = buttonGroup.querySelector('i');
                    
                    buttonGroup.addEventListener('click', function() {
                        if (icon.classList.contains('fa-regular')) {
                            // Switching to filled star - show only favorites
                            icon.className = 'fa-solid fa-star';
                            buttonGroup.classList.add('selected');
                            filterFavorites(true);
                        } else {
                            // Switching to outline star - show all
                            icon.className = 'fa-regular fa-star';
                            buttonGroup.classList.remove('selected');
                            filterFavorites(false);
                        }
                    });
                });

                function filterFavorites(showOnlyFavorites) {
                    // Get favorites from localStorage
                    const favoriteHeroes = JSON.parse(localStorage.getItem('favoriteHeroes') || '[]');
                    const rows = document.querySelectorAll('#heroesTable tr');

                    rows.forEach(function(row, index) {
                        if (index === 0) return; // Skip header row
                        
                        const heroHandle = row.querySelector('td:nth-child(2) span').textContent;
                        
                        if (showOnlyFavorites) {
                            // Show row only if hero is in favorites
                            row.style.display = favoriteHeroes.includes(heroHandle) ? '' : 'none';
                        } else {
                            // Show all rows
                            row.style.display = '';
                        }
                    });
                }

            // Function to search
            function searchHeroes() {
                document.getElementById('hero-search-box').addEventListener('input', function() {
                    var searchTerm = this.value.toLowerCase();
                    var rows = document.querySelectorAll('#heroesTable tr');
                    rows.forEach(function(row, index) {
                        if (index === 0) return; // Skip the header row
                        var playerHandleCell = row.querySelector('td:nth-child(2)');
                        if (playerHandleCell) {
                            var playerHandle = playerHandleCell.textContent.toLowerCase();
                            if (playerHandle.includes(searchTerm)) {
                                row.style.display = '';
                            } else {
                                row.style.display = 'none';
                            }
                        }
                    });
                });
            }

            function sortTable(column, descending) {
                var table = document.getElementById("heroesTable");
                var rows = Array.from(table.rows).slice(1); // Convert to array and skip header
                
                // Find the column index based on the data-sort attribute
                var headerCells = table.rows[0].cells;
                var columnIndex = Array.from(headerCells).findIndex(cell => cell.getAttribute('data-sort') === column);
                
                if (columnIndex === -1) return; // Exit if column not found

                // Remove the special case for hero_fantasy_score
                const ascending = !descending;

                rows.sort((a, b) => {
                    let aCell = a.cells[columnIndex];
                    let bCell = b.cells[columnIndex];
                    
                    // Use the raw values stored in data-value
                    let aValue = parseFloat(aCell.getAttribute('data-value')) || 0;
                    let bValue = parseFloat(bCell.getAttribute('data-value')) || 0;

                    return ascending ? aValue - bValue : bValue - aValue;
                });

                // Reinsert rows in new order
                rows.forEach(row => table.appendChild(row));
                
                updateRanks(); // Call to update ranks after sorting
            }

            // Ensure that the ranking is based on hero_fantasy_score
            function updateRanks() {
                var rows = document.querySelectorAll('#heroesTable tr');
                let currentRank = 1; // Start ranking from 1
                let lastValue = null; // To track the last value for skipping identical ranks
                let lastRank = 1; // To track the last assigned rank

                rows.forEach((row, index) => {
                    if (index === 0) return; // Skip header row
                    var rankCell = row.querySelector('td.rank');
                    if (rankCell) {
                        let currentValue = parseFloat(row.querySelector('td[data-value]').getAttribute('data-value')) || 0;

                        // If the current value is the same as the last value, keep the same rank
                        if (currentValue === lastValue) {
                            rankCell.textContent = lastRank; // Same rank for identical values
                        } else {
                            rankCell.textContent = currentRank; // Assign new rank
                            lastRank = currentRank; // Update lastRank to current
                        }
                        lastValue = currentValue; // Update lastValue to current
                        currentRank++; // Increment rank for next unique value
                    }
                });
            }

            // Add click event listeners to the headers
            document.addEventListener('DOMContentLoaded', function() {
                const headers = document.querySelectorAll('th[data-sort]');
                headers.forEach(header => {
                    header.addEventListener('click', function() {
                        const column = this.getAttribute('data-sort');
                        
                        // Find current sort direction
                        const currentArrow = this.querySelector('.sort-arrow.active');
                        const isDescending = currentArrow && currentArrow.classList.contains('down');
                        
                        // Reset all arrows in all headers
                        document.querySelectorAll('.sort-arrow').forEach(arrow => {
                            arrow.classList.remove('active');
                        });
                        
                        // Toggle between ascending and descending
                        const newArrow = this.querySelector(isDescending ? '.sort-arrow.up' : '.sort-arrow.down');
                        if (newArrow) {
                            newArrow.classList.add('active');
                        }
                        
                        // For hero_fantasy_score, we want to maintain descending as default
                        const descending = (column === 'hero_fantasy_score') 
                            ? (isDescending ? false : true)  // Toggle between true/false
                            : (isDescending ? false : true); // Toggle between true/false

                        sortTable(column, descending);
                    });
                });
            });

            // Initialize search functionality
            searchHeroes();
            </script>
            <script src="/js/config.js" defer></script>
            <script src="/js/timeUtils.js" defer></script>
        </body>
        </html>
        